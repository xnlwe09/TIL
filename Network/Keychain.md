# Keychain

## Keychain이란?

Apple이 제공하는 보안 프레임워크

사용자가 데이터를 안전하게 저장할 수 있도록 암호화된 데이터베이스

Keychain Server API를 사용하면 키체인 안에 사용자 데이터를 저장할 수 있음!

보안이 필요한 데이터를 암호화하고 이 정보를 사용할 때 복호화하여 재사용하는 방식

**“길고 어려운 암호를 만들어도 내가 대신 기억해줄게!! (넌 기억 안해도 댐. 내가 대신 인증해줌)”**

**“암호 탈취가 걱정이라면? 요거 우리가 다 알아서 암호화해서 갖고 있을거임 걱정 노노."**

### 무엇을 저장할까요

- 로그인 및 암호 (해시)
- 결제 데이터
- 암호키
- 인증키
- 메모

등 안전하게 저장해야 하는 작은 데이터를 저장할 때 사용

## Keychain의 특징

- iOS에서 앱은 단일 키체인(논리적으로 iCloud 키체인을 포함)에 액세스 가능
- SandBox 외부에 데이터가 저장되기 때문에 앱을 삭제해도 데이터가 남아있음
    - SandBox : 외부로부터 들어온 프로그램이 보호된 영역에서 동작해 시스템이 부정하게 조작되는 것을 막는 보안 형태
- 사용자가 잠금을 해제 → 키체인 자동 잠금 해제 / 장치 잠금 → 키체인 잠금
- 앱은 자신의 키체인 항목 또는 앱이 속한 그룹과 공유된 항목에만 액세스 가능
- 키체인 컨테이너 자체를 관리할 수 없음
- KeychinSharing을 통해 같은 개발자가 개발한 여러 앱에서 키체인 정보를 공유 가능

## Keychain Items

Keychain에 저장되는 Data 단위 → 키체인에 저장되는 기밀 정보는 item으로 패키징

키체인은 하나 이상의 item을 가지며, data 자체와 함께 공개적으로 볼 수 있는 attribute를 제공하여

item의 접근성을 제어하고 검색할 수 있도록 함

## Keychain Item Class

Keychain item은 암호, 암호 키 및 인증서와 같이 저장하는 데이터 종류에 따라 다양한 클래스로 제공

item의 클래스는 적용되는 attribute를 결정하고 시스템이 디스크에서 데이터를 암호화해야 하는지 여부를 결정할 수 있도록 함 (ex 암호 = 암호화가 필요함 / 인증서 = 암호화 안됨(비밀이 아니기 때문에))

key(kSecClass)-value 쌍(Dictionary 타입)을 이용해 새로운 item의 클래스를 지정하고

item을 조회(업데이트 또는 삭제 시)하는 경우도 이와 동일한 쌍을 사용

### Keychain에 저장하는 데이터 종류(value 값에 해당)

<aside>

**📍kSecClassGenericPassword**

일반 암호 항목을 나타내는 값
**📍kSecClassInternetPassword**

인터넷 비밀번호 항목을 나타내는 값

**📍kSecClassCerticate**

인증서 항목을 나타내는 값

**📍kSecClassIdentity**

ID를 나타내는 값

**📍kSecClassKey**
암호화 키 항목을 나타내는 값

</aside>

**UserDefault와 Keychain의 차이점**

보안성 : UserDefault <<<< Keychain

데이터 생명주기 : UserDefault = 데이터 휘발성 / Keychain = 데이터 비휘발성

---

## 📊 또다른 데이터 저장 방법

### UserDefaults

앱을 실행할 때 지속적으로 키-값 쌍을 저장하는 사용자의 기본 데이터베이스에 대한 인터페이스

싱글톤 패턴으로 설계 → 공용으로 사용가능하기 때문에 필요한 정보를 꺼내서 사용 가능

싱글톤 패턴 : 특정 용도로 객체를 하나만 생성하여 공용으로 사용하고 싶을 때 사용하는 디자인 유형

UserDefaults를 사용하면 앱의 어느 곳에서나 데이터를 쉽게 읽고 저장 가능

앱의 설정 같은 가벼운 데이터를 저장하기에 적합

⭐️ 하지만 암호화되지 않아 보안이 필요한 데이터에는 부적합함

### CloudKit

Apple이 제공하는 클라우드 서비스 프레임워크

iCloud 서비스를 사용하여 데이터를 클라우드에 저장하고 동기화함

CloudKit을 사용하여 데이터를 저장하면 앱의 데이터를 iCloud에 저장하고,

모든 기기와 웹에서 데이터를 최신 상태로 유지 가능

사용자의 Apple ID에 연동되어 여러 기기 간에 데이터 동기화 지원, 자동으로 관리 및 백업

### Core Data

CloudKit을 사용하여 디바이스에 데이터를 유지 또는 cahce 할 수도 있고,

데이터를 여러 장치에 동기화하는 Apple 프레임워크 (데이터베이스 ❌)

복잡한 데이터 모델과 관계를 관리하고 대량의 구조화된 데이터를 로컬에서 처리하는데 적합

+ 오프라인에서 어플리케이션의 영구적인 데이터를 저장하고 일시적인 데이터를 캐시할 수 있음

보통 CoreData와 CloudKit을 같이 사용하면 좋다함